<div id="proficiency-panel" style="min-width: 280px;">
  <div class="h4">
    Proficiencies
  </div>
  <table style="border-width: 0px" class="table table-responsive table-ac-bordered table-hover">
    <thead>
      <tr>
        <th data-bind="click: function(){sortBy('name');}">
          Proficiency
          <span data-bind="css: sortArrow('name')"></span>
        </th>
        <th data-bind="click: function(){sortBy('type');}">
          Type
          <span data-bind="css: sortArrow('type')"></span>
        </th>
      </tr>
    </thead>
    <tbody>
      <!-- ko foreach: filteredAndSortedProficiencies -->
      <tr data-toggle="collapse" class="clickable expandRow" data-bind="attr:{'data-target': `#proficiency_list_${__id}`, id: `#proficiency_row_${__id}`}">
        <td style="text-align: left"><span data-bind="text: name"></span></td>
        <td><span data-bind="text: type"></span></td>
        <td>
          <span data-toggle="collapse" data-bind="attr:{'data-target': `#proficiency_list_${__id}`}" class="rotate fa fa-chevron-left"></span>
        </td>
      </tr>
      <tr style="backgound-color: white !important; height: 100%">
        <td colspan="3" style="padding: 0px; height: 100%">
          <flip-card params="{
                viewData: $data,
                generateBlank: $parent.generateBlank,
                collapsable: true,
                saveCallback: $parent.update,
                remove: $parent.removeProficiency,
                elementId: 'proficiency_list'
              }">
            <div class="front" data-bind="with: viewData">
              <!-- ko if: description -->
              <p data-bind="markdownPreview: description "></p>
              <!-- /ko -->
              <!-- ko ifnot: description -->
              <p>No Description</p>
              <!-- /ko -->
            </div>
            <div class="back" data-bind="with: currentEditItem">
              <form style="padding: 10px; text-align: left" data-bind="submit: $parent.save">
                <div class="form-group">
                  <label for="name" class="control-label">Name</label>
                  <input type="text" class="form-control proficiencyEditNameInput" placeholder="Daggers" data-bind='textInput: name'>
                </div>
                <div class="form-group">
                  <label for="type" class="control-label">Type</label>
                  <input type="text" class="form-control proficiencyEditTypeInput" placeholder="Weapon" data-bind='textInput: type'>
                </div>
                <div class="form-group">
                  <label for="npcDescription" class="control-label">Description</label>
                  <textarea type="text" rows="3" class="form-control" id="proficiencyEditDescriptionTextarea" data-bind='value: description, markdownEditor: true'></textarea>
                </div>
                <div>
                  <button class="btn btn-sm btn-danger" type="button" data-bind="click: $parent.remove">Delete</button>
                  <div style="float: right">
                    <button class="btn btn-sm btn-default " type="button" data-bind="click: $parent.cancel">Cancel</button>
                    <button class="btn btn-sm btn-primary" type="submit">Save</button>
                  </div>
                </div>
              </form>
            </div>
          </flip-card>
        </td>
      </tr>
      <!-- /ko -->
      <!-- ko if: filteredAndSortedProficiencies().length == 0 -->
      <tr class="clickable">
        <td data-toggle="collapse" data-target="#add-proficiency" href="#" colspan="4" class="text-center">
          <i class="fa fa-plus fa-color"></i> Add a new Proficiency
        </td>
      </tr>
      <!-- /ko -->
    </tbody>
    <tfoot>
      <tr>
        <td colspan="4">
          <form data-bind="submit: addProficiency">
            <div data-bind="with: addProficiencyItem">
              <div style="padding: 10px" id="add-proficiency" class="collapse">

                <div class="form-group">
                  <label for="name" class="control-label">Name</label>
                  <input type="text" class="form-control proficiencyEditNameInput" placeholder="Daggers" data-bind='textInput: name,
                              autocomplete: { source: $parent.proficienciesPrePopFilter,
                              onselect: $parent.populateProficiency }, hasFocus: $parent.elementHasFocus'>
                </div>
                <div class="form-group">
                  <label for="type" class="control-label">Type</label>
                  <input type="text" class="form-control proficiencyEditTypeInput" placeholder="Weapon" data-bind='textInput: type,
                              autocomplete: { source: proficiencyType,
                                              onselect: $parent.setType}'>
                </div>
                <div class="form-group">
                  <label for="npcDescription" class="control-label">Description</label>
                  <textarea type="text" rows="3" class="form-control" id="proficiencyEditDescriptionTextarea" data-bind='value: description, markdownEditor: true'></textarea>
                </div>
              </div>

            </div>
            <center>
              <button type="button" class="btn btn-primary btn-sm collapseAddButton" id="proficiencyAddButton" data-toggle="collapse" data-target="#add-proficiency">Add Proficiency</button>
              <button type="button" class="btn btn-default btn-sm collapseFormButton" id="proficiencyAddCancelButton" data-toggle="collapse" data-target="#add-proficiency" data-bind='click: cancelAddProficiency'>Cancel</button>
              <button type="submit" class="btn btn-primary btn-sm collapseFormButton" id="proficiencyAddAddButton" data-toggle="collapse" data-target="#add-proficiency">Add</button>
            </center>
            <p class="text-muted text-left" data-bind='visible: shouldShowDisclaimer'>
              <sm><i>This data is distributed under the
                      <a href='http://media.wizards.com/2016/downloads/DND/SRD-OGL_V5.1.pdf'
                        target='_blank'>
                        OGL</a><br/>
                        Open	Game	License	v	1.0a	Copyright	2000,	Wizards	of	the	Coast,	LLC.
                      </i>
                <sm>
            </p>
          </form>
        </td>
      </tr>
    </tfoot>
  </table>
</div>
