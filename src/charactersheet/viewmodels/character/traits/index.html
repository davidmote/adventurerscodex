<div id="trait-panel">
  <div class="h4">
    Traits
  </div>
  <table style="border-width: 0px" class="table table-responsive table-ac-bordered table-hover">
    <thead>
      <tr>
        <th data-bind="click: function(){sortBy('name');}" >
          Trait
          <span data-bind="css: sortArrow('name')"></span>
        </th>
          <th data-bind="click: function(){sortBy('race');}" >
            Race
            <span data-bind="css: sortArrow('race')"></span>
        </th>
        <th>
          <a href="#" class="" data-bind="{click: collapseAll}">
              <span class="fa fa-minus"></span></a>
        </th>
      </tr>
    </thead>
    <tbody>
      <!-- ko foreach: filteredAndSortedTraits -->
      <tr data-toggle="collapse" class="clickable expandRow" data-bind="attr:{'data-target': `#trait_list_${__id}`, id: `#trait_row_${__id}`}">
        <td style="text-align: left"><span data-bind="text: $component.shortName(name)"></span></td>
        <td style="text-align: left"><span data-bind="text: race"></span></td>
        <td>
          <span data-toggle="collapse" data-bind="attr:{'data-target': `#trait_list_${__id}`}" class="rotate fa fa-chevron-left"></span>
        </td>
      </tr>
      <tr style="backgound-color: white !important; height: 100%">
        <td colspan="3" style="padding: 0px; height: 100%">
          <flip-card params="{
                dataId: $data.__id,
                context: {
                  data: $data,
                  addTrait: $component.addTrait,
                  removeTrait: $component.removeTrait
                }
                collapsable: true,
                elementId: 'trait_list'
              }">
            <div class="front" data-bind="with: context.data">
              <div class="h4">
                <span data-bind="text:name"></span>
                <small><span data-bind="text: race"></span></small>
              </div>
              <!-- ko if: description -->
              <p style="text-align:justify" data-bind="markdownPreview: description "></p>
              <!-- /ko -->
              <!-- ko ifnot: description -->
              <p>No Description</p>
              <!-- /ko -->
            </div>
            <div class="back" >
               <trait-form params="{
              data: context.data,
              containerId: elementId,
              showForm: editMode,
              toggle: toggleCallback,
              resizeCallback: resizeCallback,
              add: context.addTrait,
              remove: context.removeTrait
               }"
              ></trait-form>
            </div>
          </flip-card>
        </td>
      </tr>
      <!-- /ko -->
    </tbody>
    <tfoot>
      <tr>
        <td colspan="4">
          <div style="padding: 10px"  id="add-trait" class="collapse">
             <trait-form params="{
            data: null,
            containerId: 'add-trait',
            showForm:  $component.showAddForm,
            toggle: $component.toggleAddForm,
            resizeCallback: ()=>{},
            add: $component.addTrait,
          }">
        </trait-form>
        </div>
        <!-- ko ifnot: $component.showAddForm -->
         <center>
          <button type="button"
                  class="btn btn-default btn-sm btn-block"
                  id="proficiencyAddButton"
                  data-toggle="collapse"
                  data-target="#add-trait"
                  data-bind="click: toggleAddForm"><i class="fa fa-plus"></i> Add Trait</button>
          </center>
          <!-- /ko -->
        </td>
      </tr>
    </tfoot>
  </table>
</div>
