<div id="weapon-pane"
     class="ac-pane panel-body">
  <div class="h4 card-title">
    Weapons<br />
    <small>A weapon's To Hit bonus is automatically calculated based on
       your Strength or Dexterity, proficiency bonus, magical modifier,
       and property. Use the To Hit Modifier to adjust for features, feats,
       or special cases.</small>
  </div>
  <table class="table table-responsive table-ac-bordered table-hover"
         id="weaponTable">
    <thead >
      <tr class="ac-table-header">
        <th id="weaponTableWeaponHeader"
            data-bind="click: function(){sortBy('weaponName');}">
          Weapon
          <span data-bind="css: sortArrow('weaponName')"></span>
        </th>
        <th id="weaponTableToHitHeader"
            data-bind="click: function(){sortBy('totalBonus');}">
          To Hit
          <span data-bind="css: sortArrow('totalBonus')"></span>
        </th>
        <th id="weaponTableDamageHeader"
            data-bind="click: function(){sortBy('weaponDmg');}">
          Damage
          <span data-bind="css: sortArrow('weaponDmg')"></span>
        </th>
        <th id="weaponTableDamageTypeHeader"
            class="hidden-xs"
            data-bind="click: function(){sortBy('weaponDamageType');}">
          <!-- class="hidden-sm hidden-xs hidden-md" -->
          Damage Type
          <span data-bind="css: sortArrow('weaponDamageType')"></span>
        </th>
        <th id="weaponTableRangeHeader"
            class="hidden-xs"
            data-bind="click: function(){sortBy('weaponRange');}">
          <!-- class="hidden-sm hidden-xs" -->
          Range
          <span data-bind="css: sortArrow('weaponRange')"></span>
        </th>
        <th id="weaponTablePropertyHeader"
            class="hidden-xs  hidden-sm"
            data-bind="click: function(){sortBy('weaponProperty');}">
          <!-- class="hidden-sm hidden-xs hidden-md" -->
          Property
          <span data-bind="css: sortArrow('weaponProperty')"></span>
        </th>
        <th id="weaponTableQuantityHeader"
            class="hidden-xs"
            data-bind="click: function(){sortBy('weaponQuantity');}">
          <!-- class="hidden-sm hidden-xs" -->
          Quantity
          <span data-bind="css: sortArrow('weaponQuantity')"></span>
        </th>
        <th>
          <a href="#"
             data-bind="{click: collapseAll}">
                  <span class="fa fa-minus"></span>
                </a>
        </th>
      </tr>
    </thead>
    <tbody>
      <!-- ko foreach: filteredAndSortedWeapons -->
      <tr class="clickable expandRow"
          data-toggle="collapse"
          data-bind="attr:{'data-target': `#weapon_list_${__id}`}">
        <td>
          <span data-bind="text: weaponName">
              </span>&nbsp;
          <span data-bind="text: magicalModifierLabel, css: { badge: applyMagicalModifierLabel }">
              </span>
        </td>
        <td>
          <span data-bind="text: hitBonusLabel"></span>
        </td>
        <td><span data-bind="text: weaponDmg"
                href="#"></span>
        </td>
        <td class="hidden-xs">
          <span data-bind="text: weaponDamageType"></span>
        </td>
        <td class="hidden-xs">
          <span data-bind="text: weaponRangeLabel"></span>
        </td>
        <td class="hidden-xs  hidden-sm">
          <span data-bind="text: weaponProperty"></span>
        </td>
        <td class="hidden-xs">
          <span data-bind="text: weaponQuantity"></span>
        </td>
        <td>
          <span data-toggle="collapse"
                data-bind="attr:{'data-target': `#weapon_list_${__id}`}"
                class="rotate fa fa-chevron-left"></span>
        </td>
      </tr>
      <tr class="collapseRow">
        <td colspan="8">
          <flip-card params="{
                  dataId: $data.__id,
                  collapsable: true,
                  elementId: 'weapon_list',
                  context: {
                    data: $data,
                    remove: $component.removeWeapon
                  }
                }">
            <div class="front">
              <div class="h4">
                <span data-bind="text: context.data.weaponName"
                      class="weaponPreviewNameLabel"></span>
                <small data-bind="text: context.data.magicalModifierLabel"
                       class="weaponPreviewMagicalModifierLabel"></small>
              </div>
              <div class="row" data-bind="with: context.data">
                <div class="col-sm-6 col-md-4 col-lg-3">
                  <table class="spellDetail table table-hover table-condensed table-ac-bordered">
                    <tbody>
                      <tr>
                        <th style="width: 40%">To Hit:</th>
                        <td ><strong data-bind="text: hitBonusLabel"></strong><span data-bind="text: magicalModifierLabel, css: { badge: applyMagicalModifierLabel }"></span> </td>
                      </tr>
                      <tr>
                        <th style="width: 40%">Damage:</th>
                        <td ><strong data-bind="text: weaponDmg"></strong></td>
                      </tr>
                      <tr>
                        <th style="width: 40%">Damage Type:</th>
                        <td ><span data-bind="text: weaponDamageType"></span></td>
                      </tr>
                      <tr>
                        <th style="width: 40%">Type:</th>
                        <td ><span data-bind="text: weaponType"></span></td>
                      </tr>
                      <tr>
                        <th style="width: 40%">Range:</th>
                        <td ><span data-bind="text: weaponRangeLabel"></span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div class="col-sm-6 col-md-4 col-md-push-4 col-lg-3 col-lg-push-6">
                  <table class="spellDetail table table-hover table-condensed table-ac-bordered">
                    <tbody>
                      <tr>
                        <th style="width: 40%">Quantity:</th>
                        <td ><span data-bind="text: weaponQuantity"></span></td>
                      </tr>
                      <tr>
                        <th style="width: 40%">Handedness:</th>
                        <td ><span data-bind="text: weaponHandedness"></span></td>
                      </tr>
                      <tr>
                        <th style="width: 40%">Property:</th>
                        <td ><span data-bind="text: weaponProperty"></span></td>
                      </tr>
                      <tr>
                        <th style="width: 40%">Proficiency:</th>
                        <td ><span data-bind="text: weaponProficiency"></span></td>
                      </tr>
                      <tr>
                        <th style="width: 40%">Weight:</th>
                        <td ><span data-bind="text: weaponWeightLabel"></span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div class="col-xs-12 col-md-4 col-md-pull-4 col-lg-6 col-lg-pull-3">
                  <p data-bind="html: weaponDescriptionHTML"
                     id="weaponPreviewDescriptionTextarea"
                     class="card-description" style="text-align: center">
                  </p>
                </div>

              </div>
            </div>
            <div class="back">
              <weapon-form params="{
              data: context.data,
              containerId: elementId,
              showForm: editMode,
              toggle: toggleCallback,
              remove: context.remove }">
              </weapon-form>
            </div>
          </flip-card>
        </td>
      </tr>
      <!-- /ko -->
      <tr class="collapseRow">
        <td colspan="8">
          <div id="add-weapon" class="collapse add-card">
            <weapon-form params="{
              data: null,
              containerId: 'add-weapon',
              showForm: $component.showAddForm,
              add: $component.addWeapon,
              toggle: $component.toggleAddForm }">
            </weapon-form>
          </div>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td colspan="8">
          <div class="row">
          <div class="col-xs-4 text-muted">
            <small class="table-foot-content visible-xs"><span id="weaponTableTotalWeightSpan" data-bind="text: totalWeight"></span></small>
            <span class="table-foot-content hidden-xs">Weight: <span id="weaponTableTotalWeightSpan" data-bind="text: totalWeight"></span></span>
          </div>
          <div class="col-xs-4">
            <!-- ko ifnot: $component.showAddForm -->
            <button type="button"
                    class="btn btn-link btn-sm btn-block"
                    id="weaponAddButton"
                    data-toggle="collapse"
                    data-target="#add-weapon"
                    data-bind="click: toggleAddForm"><i class="fa fa-plus"></i> Add Weapon</button>
            <!-- /ko -->
          </div>
            <div class="col-xs-4 text-muted">
          <!-- this space for value -->
          </div>
        </td>
      </tr>
    </tfoot>
  </table>
</div>
