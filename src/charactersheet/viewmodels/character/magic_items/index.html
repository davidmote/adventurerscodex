<div id="magic-item-pane"
     class="ac-pane panel-body">
  <div class="h4 card-title">
    Magic Items<br/>
    <small>“This should be in a museum!” -Indiana Jones</small>
  </div>
  <table class="table table-responsive table-ac-bordered table-hover"
         id="magicItemsTable">
    <thead >
      <tr class="ac-table-header">
        <th id="magicItemsAttunedHeader"
            data-bind="click: function(){sortBy('magicItemAttuned');}">
          Attuned
          <span data-bind="css: sortArrow('magicItemAttuned')"></span>
        </th>
        <th id="magicItemsMagicItemHeader"
            data-bind="click: function(){sortBy('magicItemName');}">
          Magic Item
          <span data-bind="css: sortArrow('magicItemName')"></span>
        </th>
        <th id="magicItemsMagicItemHeader" class="hidden-xs"
            data-bind="click: function(){sortBy('magicItemType');}">
          Type
          <span data-bind="css: sortArrow('magicItemType')"></span>
        </th>
        <th id="magicItemsChargesHeader" class="hidden-xs"
            data-bind="click: function(){sortBy('magicItemCharges');}">
          Charges
          <span data-bind="css: sortArrow('magicItemCharges')"></span>
        </th>
        <th>
          <a href="#"
             data-bind="{click: collapseAll}">
                  <span class="fa fa-minus"></span>
                </a>
        </th>
      </tr>
    </thead>
    <tbody>
      <!-- ko foreach: filteredAndSortedMagicItems -->
      <tr class="clickable expandRow"
          data-toggle="collapse"
          data-bind="css: {notCastable: magicItemRequiresAttunement() == true && !magicItemAttuned() }, attr:{'data-target': `#magic_item_${__id}`}">
        <td data-bind="visible: $parent.noneAttuned() === false, click: $component.attuneItem">
          <div data-bind="visible: magicItemRequiresAttunement() == true">
            <div>
              <input type='checkbox'
                     style=""
                     class='pseudo-checkbox sr-only'
                     data-bind="checked: magicItemAttuned, attr: {id: `magic_item_attuned_${__id}`}"></input>
              <label data-bind="attr: {for: `magic_item_attuned_${__id}`}"
                     class='fancy-checkbox-label'>
                  </label>
            </div>
          </div>
        </td>
        <td><span data-bind="text: magicItemName"></span></td>
        <td class="hidden-xs"><span data-bind="text: magicItemType"></span></td>
        <td class="hidden-xs"><span data-bind="text: chargesDisplay"></span></td>

        <td>
          <span data-toggle="collapse"
                data-bind="attr:{'data-target': `#magic_item_${__id}`}"
                class="rotate fa fa-chevron-left"></span>
        </td>
      </tr>
      <tr class="collapseRow">
        <td colspan="5">
          <flip-card params="{
                  dataId: $data.__id,
                  tabId: $component.tabId,
                  collapsable: true,
                  elementId: 'magic_item',
                  context: {
                    data: $data,
                    remove: $component.removeItem
                  }
                }">
            <div class="front"
                 data-bind="with: context.data">
              <div class="row">
                <div class="col-xs-12">
                  <div class="h4 pull-left">
                    <span data-bind="text: magicItemNameLabel"
                          id="magicItemsPreviewItemInput"></span>&nbsp;
                    <small data-bind="text: magicItemRarity"
                           id="magicItemsPreviewRarityInput"></small>
                  </div>
                </div>
                <div class="col-sm-5 col-md-12 col-lg-5">
                  <table class="spellDetail table table-hover table-condensed table-ac-bordered">
                    <tbody>
                      <tr>
                        <th>Type:</th>
                        <td><span data-bind="text: magicItemType"></span></td>
                      </tr>
                      <tr>
                        <th>Max Charges:</th>
                        <td><span data-bind="text: magicItemMaxCharges"></span></td>
                      </tr>
                      <tr>
                        <th>Weight:</th>
                        <td><span data-bind="text: magicItemWeightLabel"></span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div class="col-sm-7 col-md-12 col-lg-7">
                  <p style="text-align: justify"
                     data-bind="html: magicItemDescriptionHTML"></p>
                </div>
              </div>
            </div>
            <div class="back">
              <magic-item-form params="{
                  data: context.data,
                  containerId: elementId,
                  showForm: editMode,
                  toggle: toggleCallback,
                  remove: context.remove }">
              </magic-item-form>
            </div>
          </flip-card>
        </td>
      </tr>
      <!-- /ko -->
      <tr class="collapseRow">
        <td colspan="8">
          <div id="add-magic-item"
               class="collapse add-form">
            <magic-item-form params="{
              data: null,
              containerId: 'add-magic-item',
              showForm: $component.showAddForm,
              add: $component.addItem,
              toggle: $component.toggleAddForm }">
            </magic-item-form>
          </div>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td colspan="8">
        <div class="row">
          <div class="col-xs-4 text-muted">
            <small class="table-foot-content visible-xs"><span id="magicItemsTableTotalWeight" data-bind="text: totalMagicItemWeight"></span></small>
            <span class="table-foot-content hidden-xs">Weight: <span id="magicItemsTableTotalWeight" data-bind="text: totalMagicItemWeight"></span></span>
          </div>
          <div class="col-xs-4">
            <!-- ko ifnot: $component.showAddForm -->
            <button type="button"
                    class="btn btn-link btn-sm btn-block"
                    id="magicitemAddButton"
                    data-toggle="collapse"
                    data-target="#add-magic-item"
                    data-bind="click: toggleAddForm"><i class="fa fa-plus"></i> Add Magic Item</button>
            <!-- /ko -->
          </div>
            <div class="col-xs-4 text-muted">
          <!-- this space for value -->
          </div>
        </td>
      </tr>
    </tfoot>
  </table>
  <!--
    <div class="container-fluid panel-footer">
       <span class="pull-right">Total weight:&nbsp;
        <span id="magicItemsTableTotalWeight" data-bind="text: totalMagicItemWeight"></span>
      </span>
    </div> -->

</div>
