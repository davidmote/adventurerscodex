<div id="spells-pane" class="ac-pane panel-body">
    <div class="h4 card-title">
      Spells<br/>
      <small>You can sort your spells by clicking on the headers. View the
    bottom of the list for a count of your prepared spells.</small>
    </div>
    <table class="listing table table-responsive table-ac-bordered table-hover"
           id="spellsTable">
      <thead>
        <tr>
          <th id="spellsTablePreparedHeader">
            <input id="filterByCastable"
                   type='checkbox'
                   class='filter-checkbox sr-only'
                   data-bind="checked: filteredByCastable"></input>
            <label for="filterByCastable">
                   <!-- <small class="hidden-xs">Memorized</small> -->
           </label>
          </th>
          <th id="spellsTableSpellHeader"
              data-bind="click: function(){sortBy('spellName');}">
            Spell
            <span data-bind="css: sortArrow('spellName')"></span>
          </th>
          <th id="spellsTableLevelHeader" class="ac-table-data-cell"
              data-bind="click: function(){sortBy('spellLevel');}">
            Level
            <span data-bind="css: sortArrow('spellLevel')"></span>
          </th>
          <th id="spellsTableTypeHeader" class="hidden-xs"
              data-bind="click: function(){sortBy('spellTypeLabel');}">
            Type
            <span data-bind="css: sortArrow('spellTypeLabel')"></span>
          </th>
          <th id="spellsTableDamageHeader" class="hidden-xs hidden-sm"
              data-bind="click: function(){sortBy('spellDmg');}">
            Damage
            <span data-bind="css: sortArrow('spellDmg')"></span>
          </th>
          <th id="spellsTableCastingHeader"  class="hidden-xs"
              data-bind="click: function(){sortBy('spellCastingTime');}">
            Casting Time
            <span data-bind="css: sortArrow('spellCastingTime')"></span>
          </th>
          <th id="spellsTableRangeHeader"  class="hidden-xs hidden-sm"
              data-bind="click: function(){sortBy('spellRange');}">
            Range
            <span data-bind="css: sortArrow('spellRange')"></span>
          </th>
          <th style="width: 5%" class="toggle-collapse-col">
            <a href="#" data-bind="{click: collapseAll}">
                  <span class="fa fa-minus"></span>
                </a>
          </th>
        </tr>
      </thead>
      <tbody>
        <!-- ko foreach: filteredAndSortedSpells -->
        <tr
            data-toggle="collapse"
            class="clickable spellRow"
            data-bind="css: {notCastable: !spellIsCastable()}, attr:{'data-target': `#spell_list_${__id}`, id: `#spell_row_${__id}`}">
          <td class="memorize-spell"
              data-bind="click: $parent.memorizeSpell">
            <!-- ko ifnot: spellLevel() == 0  || spellAlwaysPrepared -->
            <div>
              <input type='checkbox'
                     style=""
                     class='ac-checkbox sr-only'
                     data-bind="checked: spellPrepared, attr: {id: `spell_memorize_${__id}`}"></input>
              <label data-bind="attr: {for: `spell_memorize_${__id}`}"></label>
            </div>
            <!-- /ko -->
            <!-- ko if: spellLevel() == 0  || spellAlwaysPrepared -->
            <span class="glyphicon glyphicon-ok-sign"></span>
            <!-- /ko -->
          </td>
          <td>
            <span data-bind="text: spellName"></span>
            <!-- ko if: isConcentration -->
            <span style="color: #18bc9c"
                  class="glyphicon glyphicon-copyright-mark"></span>
            <!-- /ko -->
          </td>
          <td class="ac-table-data-cell">
            <span data-bind="text: spellLevelLabel"></span>
          </td>
          <td class="hidden-xs">
            <span data-bind="text: spellTypeLabel"></span>
          </td>
          <td class="hidden-xs  hidden-sm">
            <span data-bind="text: spellDamageLabel"></span>
          </td>
          <td class="hidden-xs">
            <span data-bind="text: spellCastingTime"></span>
            <!-- ko if: isRitual -->
            <span style="color: #18bc9c"
                  class="glyphicon glyphicon-registration-mark"></span>
            <!-- /ko -->
          </td>
          <td class="hidden-xs hidden-sm">
            <span data-bind="text: $component.trunc(spellRange, 10)"></span>
          </td>
          <td style="width: 5%" class="toggle-collapse-col">
            <span data-toggle="collapse"
                  data-bind="attr:{'data-target': `#spell_list_${__id}`}"
                  class="rotate fa fa-chevron-left"></span>
          </td>
        </tr>
        <tr class="collapseRow safari-card-fix">
          <td colspan="8">
            <flip-card params="{
                  dataId: $data.__id,
                  collapsable: true,
                  elementId: 'spell_list',
                  context: {
                    data: $data,
                    remove: $component.removeSpell,
                  }
                }">
              <div class="front">
                <div data-bind="with: context.data, css: context.data.spellSchool().toLowerCase()">
                  <div class="h4">
                    <span data-bind="text: spellNameLabel"></span>&nbsp;
                    <small data-bind="text: spellSummaryLabel"></small>
                  </div>
                  <div class="row">
                    <div class="col-sm-5">
                      <table class="spellDetail table table-hover table-condensed table-ac-bordered">
                        <tbody>
                          <tr>
                            <th>Type:</th>
                            <td><span data-bind="text: spellType"></span></td>
                          </tr>
                          <!-- ko if: spellDamageLabel -->
                          <tr>
                            <th>Damage:</th>
                            <td><span data-bind="text: spellDamageLabel"></span></td>
                          </tr>
                          <!-- /ko -->
                          <tr>
                            <th>Casting Time:</th>
                            <td><span data-bind="text: spellCastingTime"></span></td>
                          </tr>
                          <tr>
                            <th>Range:</th>
                            <td><span data-bind="text: spellRange"></span></td>
                          </tr>
                          <tr>
                            <th>Duration:</th>
                            <td><span data-bind="text: spellDuration"></span></td>
                          </tr>
                          <tr>
                            <th>Components:</th>
                            <td><span data-bind="text: spellComponents"></span></td>
                          </tr>
                          <!-- ko if: spellMaterialComponents -->
                          <tr>
                            <td colspan="2"><i data-bind="text: spellMaterialComponents"></i></td>
                          </tr>
                          <!-- /ko -->
                        </tbody>
                      </table>
                    </div>
                    <div class="col-sm-7">
                        <div class="card-description" data-bind="html: spellDescriptionHTML"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="back">
                <div data-bind="css: context.data.spellSchool().toLowerCase()">
                <spell-form params="{
                      data: context.data,
                      containerId: elementId,
                      showForm: editMode,
                      toggle: toggleCallback,
                      remove: context.remove
                    }"></spell-form>
                  </div>
              </div>
            </flip-card>
          </td>
        </tr>
        <!-- /ko -->
        <!-- ko if: spellbook().length > 0 && filteredAndSortedSpells().length == 0 -->
        <tr class="clickable">
          <td href="#"
              colspan="8"
              class="text-center">
            No Spells are currently castable
          </td>
        </tr>
        <!-- /ko -->
        <tr id="add-spell" class="collapse">
          <td colspan="8">
              <spell-form params="{
                    data: null,
                    containerId: 'add-spell',
                    showForm: $component.showAddForm,
                    add: $component.addSpell,
                    toggle: $component.toggleAddForm
                  }"></spell-form>
          </td>
        </tr>
      </tbody>
      <tfoot>
        <tr>
          <td colspan="8">
            <div class="row">
            <div class="col-xs-4 text-muted">
              <small class="table-foot-content visible-xs">Prepared: <span data-bind="text: $component.numberOfPrepared"></span></small>
            </div>
            <div class="col-xs-4">
              <!-- ko ifnot: $component.showAddForm -->
            <button type="button"
                    class="btn btn-link btn-sm"
                    id="spellAddButton"
                    data-toggle="collapse"
                    data-target="#add-spell"
                    data-bind="click: toggleAddForm"><i class="fa fa-plus"></i> Add Spell</button>
              <!-- /ko -->
            </div>
              <div class="col-xs-4 text-muted">
                <small class="table-foot-content pull-right visible-xs">Spells: <span data-bind="text: $component.numberOfSpells"></span>
              </div>
            </div>
          </td>
        </tr>
      </tfoot>
    </table>
</div>
